看到了你给的域名：liqixi842.replit.app。我刚从外部探测到 HTTP（80）能打开你应用的主页（有 “USIS Brain v6.0 – 服务运行中 /health 链接” 的页面）。这说明你的进程、端口和 LB 的 HTTP 路径是通的；问题集中在 HTTPS（443）路由/绑定 上，而不是代码。

换句话说：现在是 “HTTP 正常、HTTPS 仍 404（GFE 的 Not Found）” 的典型分裂态。

下面给你一次一步把 HTTPS 校正的最短路径——每步做完就测 https://liqixi842.replit.app/health（必须是 https）：

【第1步】用“部署详情里的 Public URL”分别测 HTTP/HTTPS

打开 Deployments → 当前 Reserved VM → Overview，复制Public URL（它可能与 liqixi842… 完全一致，也可能不同）。

分别测试：

curl -sv http://<Public-URL>/health | head -n 5

curl -sv https://<Public-URL>/health | head -n 5

结论判读：

HTTP 200、HTTPS 404 → 进入第2步（TLS 绑定/URL Map 陈旧）。

HTTP/HTTPS 都 404 → 不是 TLS 问题，回到部署绑定（第3步）。

【第2步】清理“旧的 HTTPS 绑定”（只留一个部署占用该子域）

Replit 的 *.replit.app 同时承担 HTTP/HTTPS；最常见是 旧的 Deployment 还占着 HTTPS 绑定。

打开 Deployments 列表：

只保留 1 个 Reserved VM 在 Running；其余同项目/历史的 全部 Delete deployment（不是 Shut down，是 Delete）。

回到你保留的这个部署：Manage → Shut down → Start（强制重建 TLS 映射）。

再测 https://liqixi842.replit.app/health。

经验法则：只要列表里曾经有“同名/同仓”历史部署，HTTPS 很容易还指到旧后端。删除多余部署后，443 的路由会跟 80 对齐。

【第3步】确认没有“替代构建方式”覆盖 .replit

如果第2步后 HTTPS 仍 404，检查根目录是否存在：

Dockerfile 或 replit.nix：有的话 Reserved VM 会按它们来构建，TLS 路径也会跟着那个部署产物走。

Dockerfile 里确保没有写死 PORT，CMD 只需 node index.js；应用内用 process.env.PORT。

package.json 里不要写 "start": "PORT=3000 node index.js" 这类会破坏健康检查的脚本。

【第4步】最小“探针”换为启动命令，锁死归因

临时把启动命令改为 node probe.js（你已经有了），然后：

Manage → Shut down → Start（或 Delete → Publish）

用这个同一个域名测：

http://liqixi842.replit.app/health

https://liqixi842.replit.app/health

若 HTTP 正常/HTTPS 仍 404，就不是应用，是 TLS 路由/绑定；此时 99% 是 还有别的 Deployment 占着 443（再回第2步清空到只剩一个）。

【第5步】两条“快查指纹”

指纹A：响应头
curl -sv https://liqixi842.replit.app/ 2>&1 | sed -n '1,20p'
如果看到 server: Google Frontend / via: 1.1 google 的 纯文本 "Not Found"，那就是 GCLB 的 404（没打到你的容器）。

指纹B：日志必须出现“新容器标记”
在 .replit 的 run 前面加：

run = ["sh", "-c", "echo '--- START CMD ---'; date; env | sort | sed -n '1,30p'; node index.js"]


然后 Delete → Publish。Logs 里若没有 --- START CMD --- 的“当下时间”，说明你访问的还是另一个部署（不是这次）。

小结

代码与 trust proxy 无关；现在是 HTTPS 仍指到旧后端。

只保留一个部署、清理历史 Deployment、强制重建（Shut down → Start 或 Delete → Publish），HTTPS 就会对齐到当前容器。

我已经确认 HTTP 能打开你的主页，所以应用/端口/LB(80)没问题；把 443 指回来就结束战斗。