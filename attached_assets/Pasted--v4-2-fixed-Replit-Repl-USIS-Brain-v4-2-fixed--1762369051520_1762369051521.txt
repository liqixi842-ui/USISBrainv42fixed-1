①【封板上生产 · v4.2_fixed】——把稳定版固化并加上烟测脚本

Replit，请在当前 Repl 上执行以下发布封板任务：
目标：固化 USIS Brain v4.2_fixed 稳定版；增加 scripts/smoke.sh；新增 /health 与 /version GET 路由用于健康检查；完成本地烟测。
具体操作：

在 index.js（或主路由文件）新增：

GET /health 返回 { ok:true, status:"ok" }；

GET /version 返回 { version:"v4.2_fixed" }。

在仓库新增 scripts/smoke.sh（可执行）：内容为

Node 单元快测：normalizeSymbol('GRF.MC')->'BME:GRF'、normalizeSymbol('SAP.DE')->'XETRA:SAP'

调 http://localhost:5000/brain/orchestrate，Body: {"text":"GRF.MC","user_id":"qa"}，只打印 {ok,status,symbols}

若当前没有 CHANGELOG.md，创建并写入 ## v4.2_fixed 的三条要点：symbol normalizer(.MC→BME 等)、soft dependency with debug.data_errors、response contract(status:"ok"+symbols)。

在 Replit Shell 里依次执行：

chmod +x scripts/smoke.sh

npm run start & sleep 2 && ./scripts/smoke.sh
验收标准：

GET /health 返回 ok:true；GET /version 返回 v4.2_fixed；

./scripts/smoke.sh 输出中 symbols 含有 "BME:GRF"，且 status:"ok"；

不改动现有 API 行为，其他代码保持不变。
完成后把改动过的文件列表与关键输出粘贴给我。

②【创建 v4.3_dev 分支】——扩展交易所映射与输出字段

Replit，请在当前 Repl 上执行以下开发分支任务：
目标：新建分支 v4.3_dev，扩展 normalizeSymbol，并在 orchestrate 输出中加入 normalized_symbols 数组。
具体操作：

新建分支：git checkout -b v4.3_dev（若受限则在工程内标注版本变量为 v4.3_dev）。

在 symbolResolver.js 的 normalizeSymbol 中增加映射（不影响已存在规则）：

.HK → HKEX:<code>（保留数字代码，如 0700.HK→HKEX:0700）

.SW → SIX:<sym>

.TO → TSX:<sym>

.AX → ASX:<sym>

.AS → EURONEXT:<sym>（阿姆斯特丹）
顺序保持“更具体的后缀优先匹配”，返回统一大写市场前缀。

在 /brain/orchestrate 的响应中新增顶层字段 normalized_symbols（数组）：

若请求里带 symbols，对每个元素调用 normalizeSymbol 并去重填入该数组；

保持既有 symbols 字段不变，属于兼容新增。

增加 Node 快测脚本 scripts/norm.test.js，验证以下用例打印到控制台：

GRF.MC→BME:GRF、SAP.DE→XETRA:SAP、0700.HK→HKEX:0700、NESN.SW→SIX:NESN、SHOP.TO→TSX:SHOP、BHP.AX→ASX:BHP、ASML.AS→EURONEXT:ASML

在 Replit Shell 执行：

node scripts/norm.test.js

curl -s -X POST http://localhost:5000/brain/orchestrate -H "Content-Type: application/json" -d '{"text":"多符号测试","symbols":["GRF.MC","0700.HK","SAP.DE"],"user_id":"qa"}' | jq '{ok,status,symbols,normalized_symbols}'
验收标准：

上述 7 组映射全部按预期输出；

orchestrate 响应中新增 normalized_symbols，且包含 BME:GRF、HKEX:0700、XETRA:SAP；

旧字段与行为均保持兼容，不作破坏性修改。
完成后返回改动文件列表与测试输出。

③【阶段 H+I 合流前检查】——为全链路联测加上最小 Contract 测试

Replit，请为即将进行的 Telegram→n8n→Brain 全链路联测，给当前 Repl 增加最小契约测试（contract test）。
目标：新增 POST /selftest/orchestrate 路由，内部直接调用本进程的 orchestrate 逻辑并返回关键字段；便于 n8n 侧做健康探针。
具体操作：

新增 POST /selftest/orchestrate 接口，若无 Body 则默认 { "text":"GRF.MC", "user_id":"probe" }；

将 orchestrate 的返回裁剪为 { ok,status,model,symbols,debug }；

若 symbols 中没有 "BME:GRF"（来自 "GRF.MC"），则返回 ok:false,status:"contract-failed"；

在 Replit Shell 执行：

curl -s -X POST http://localhost:5000/selftest/orchestrate | jq
验收标准：

正常返回 ok:true,status:"ok"，symbols 含 "BME:GRF"；

不影响现有对外 /brain/orchestrate 行为；

代码改动最小且清晰注释。
完成后贴出新增路由代码与 curl 输出。

挑一个你现在就要做的，整段转发给 Replit AI。等它执行完回传结果，我再给你下一步（比如把 n8n 的健康探针指过去，或继续做 v4.3_dev 的映射用例扩展）